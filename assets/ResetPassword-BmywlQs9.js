import{_ as j,G as q,r as c,u as B,c as r,a as d,b as e,w as D,d as C,e as P,f as V,n as o,j as l,t as L,g as U,h as z,i as A,F as O,l as T,o as v}from"./index-BHCqwZJN.js";import{_ as G}from"./rustic-z3WfS5tK.js";const Z={class:"container"},H={class:"reset-container"},J={class:"reset-card"},K={class:"form-group mb-3"},Q={class:"input-group"},W=["type"],X={class:"password-requirements mt-2"},Y={class:"list-unstyled"},$={class:"form-group mb-4"},ee={class:"input-group"},se=["type"],te={key:0,class:"text-danger small mt-1"},ae={key:0,class:"alert alert-danger mb-3"},oe=["disabled"],le={key:0},re={key:1},ne={class:"text-center"},ie={__name:"ResetPassword",setup(ue){const g=q(),N=T(),x=g.params.token,_=g.params.userId,t=c(""),p=c(""),a=c(null),n=c(!1),i=c(!1),m=B(),b=r(()=>t.value.length>=8),f=r(()=>/[A-Z]/.test(t.value)),w=r(()=>/[0-9]/.test(t.value)),h=r(()=>t.value===p.value),R=r(()=>b.value&&f.value&&w.value),k=r(()=>R.value&&h.value),S=()=>{i.value=!i.value},I=()=>{a.value=null},M=async()=>{if(k.value){n.value=!0,a.value=null;try{const u=await m.verifyRecoveryToken(_,x);if(!u){a.value="El enlace de recuperación no es válido o ha expirado",n.value=!1;return}const s=await m.resetPassword(x,t.value,_);s!=null&&s.success?(await m.sendPasswordChangeSuccessEmail(u.email,t.value),E()):a.value=(s==null?void 0:s.error)||"Ocurrió un error al restablecer la contraseña"}catch(u){a.value="Ocurrió un error durante el proceso. Por favor intenta nuevamente.",console.error("Error en reset password:",u)}finally{n.value=!1}}},E=()=>{alert("¡Contraseña restablecida con éxito! Serás redirigido al login."),N.push("/login")};return(u,s)=>{const F=A("router-link");return v(),d(O,null,[s[15]||(s[15]=e("section",{class:"reset-hero position-relative"},[e("video",{class:"w-100 h-100 object-fit-cover",autoplay:"",loop:"",muted:"",playsinline:""},[e("source",{src:G,type:"video/mp4"})]),e("div",{class:"video-overlay"}),e("div",{class:"container position-relative z-index-1 h-100 d-flex align-items-center justify-content-center text-center"},[e("div",{class:"hero-content"},[e("h1",{class:"display-4 fw-bold text-white mb-3"},"Nueva Contraseña"),e("p",{class:"lead text-white text-opacity-85 mb-0"},"Crea una contraseña segura para tu cuenta")])])],-1)),e("div",Z,[e("div",H,[e("div",J,[s[14]||(s[14]=e("div",{class:"reset-header text-center mb-4"},[e("h2",{class:"fw-bold"},"Restablecer Contraseña"),e("p",{class:"text-muted"},"Ingresa y confirma tu nueva contraseña")],-1)),e("form",{onSubmit:D(M,["prevent"]),class:"reset-form"},[e("div",K,[s[7]||(s[7]=e("label",{for:"newPassword",class:"form-label"},"Nueva Contraseña",-1)),e("div",Q,[s[2]||(s[2]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-lock"})],-1)),P(e("input",{type:i.value?"text":"password",id:"newPassword","onUpdate:modelValue":s[0]||(s[0]=y=>t.value=y),required:"",class:"form-control",placeholder:"Ingresa tu nueva contraseña",onInput:I},null,40,W),[[V,t.value]]),e("span",{class:"input-group-text password-toggle",onClick:S},[e("i",{class:o(i.value?"bi bi-eye-slash":"bi bi-eye")},null,2)])]),e("div",X,[s[6]||(s[6]=e("small",{class:"d-block text-muted"},"La contraseña debe contener:",-1)),e("ul",Y,[e("li",{class:o({"text-success":b.value})},[e("i",{class:o(b.value?"bi bi-check-circle-fill":"bi bi-circle")},null,2),s[3]||(s[3]=l(" 8 caracteres mínimo "))],2),e("li",{class:o({"text-success":f.value})},[e("i",{class:o(f.value?"bi bi-check-circle-fill":"bi bi-circle")},null,2),s[4]||(s[4]=l(" 1 letra mayúscula "))],2),e("li",{class:o({"text-success":w.value})},[e("i",{class:o(w.value?"bi bi-check-circle-fill":"bi bi-circle")},null,2),s[5]||(s[5]=l(" 1 número "))],2)])])]),e("div",$,[s[9]||(s[9]=e("label",{for:"confirmPassword",class:"form-label"},"Confirmar Contraseña",-1)),e("div",ee,[s[8]||(s[8]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-lock-fill"})],-1)),P(e("input",{type:i.value?"text":"password",id:"confirmPassword","onUpdate:modelValue":s[1]||(s[1]=y=>p.value=y),required:"",class:"form-control",placeholder:"Confirma tu nueva contraseña"},null,8,se),[[V,p.value]])]),!h.value&&p.value?(v(),d("div",te," Las contraseñas no coinciden ")):C("",!0)]),a.value?(v(),d("div",ae,[s[10]||(s[10]=e("i",{class:"bi bi-exclamation-circle me-2"},null,-1)),l(" "+L(a.value),1)])):C("",!0),e("button",{type:"submit",class:"btn btn-primary w-100 py-2 mb-3",disabled:n.value||!k.value},[n.value?(v(),d("span",le,s[11]||(s[11]=[e("span",{class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},null,-1),l(" Procesando... ")]))):(v(),d("span",re,s[12]||(s[12]=[e("i",{class:"bi bi-key me-2"},null,-1),l(" Restablecer Contraseña ")])))],8,oe),e("div",ne,[U(F,{to:"/login",class:"text-decoration-none"},{default:z(()=>s[13]||(s[13]=[e("i",{class:"bi bi-arrow-left me-1"},null,-1),l(" Volver al inicio de sesión ")])),_:1})])],32)])])])],64)}}},ve=j(ie,[["__scopeId","data-v-044309c1"]]);export{ve as default};
