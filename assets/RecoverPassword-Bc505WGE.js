import{_ as g,r as u,u as w,a as n,b as s,w as k,d as m,e as h,v as E,j as o,t as p,g as R,h as C,i as I,F as N,l as P,o as i}from"./index-CgZNDQrm.js";import{_ as T}from"./rustic-CThMpSS1.js";const V={class:"container"},j={class:"recover-container"},S={class:"recover-card"},B={class:"form-group mb-4"},M={class:"input-group"},A={key:0,class:"alert alert-danger mt-2"},D={key:0,class:"alert alert-danger"},F={key:1,class:"alert alert-success"},q=["disabled"],z={key:0},H={key:1},L={class:"text-center mt-4"},O={class:"text-muted mb-0"},U={__name:"RecoverPassword",setup($){const d=u(""),a=u(!1),r=u(null),v=u(null),c=u(null),l=w(),f=P(),y=()=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;c.value=t.test(d.value)?null:"Por favor ingresa un correo electrónico válido"},_=async()=>{if(!c.value){a.value=!0,r.value=null,v.value=null;try{const t=await l.checkEmailExists(d.value);if(!t){r.value=l.error||"No encontramos una cuenta asociada a este correo",a.value=!1;return}const e=await l.createRecoveryToken(t.id);if(!(e!=null&&e.token)){r.value=l.error||"Error al generar el enlace de recuperación",a.value=!1;return}await l.sendRecoveryEmail(t,e.token)?(v.value="¡Listo! Hemos enviado un enlace de recuperación a tu correo",setTimeout(()=>{f.push("/login")},3e3)):r.value=l.error||"Error al enviar el correo de recuperación"}catch(t){r.value="Ocurrió un error inesperado. Por favor intenta nuevamente.",console.error("Error en recuperación:",t)}finally{a.value=!1}}};return(t,e)=>{const b=I("router-link");return i(),n(N,null,[e[11]||(e[11]=s("section",{class:"recover-hero position-relative"},[s("video",{class:"w-100 h-100 object-fit-cover",autoplay:"",loop:"",muted:"",playsinline:""},[s("source",{src:T,type:"video/mp4"})]),s("div",{class:"video-overlay"}),s("div",{class:"container position-relative z-index-1 h-100 d-flex align-items-center justify-content-center text-center"},[s("div",{class:"hero-content"},[s("h1",{class:"display-4 fw-bold text-white mb-3"},"Recupera tu Acceso"),s("p",{class:"lead text-white text-opacity-85 mb-0"},"Te ayudaremos a restablecer tu contraseña")])])],-1)),s("div",V,[s("div",j,[s("div",S,[e[10]||(e[10]=s("div",{class:"recover-header text-center mb-4"},[s("h2",{class:"fw-bold"},"Restablecer Contraseña"),s("p",{class:"text-muted"},"Ingresa tu correo electrónico para recibir instrucciones")],-1)),s("form",{onSubmit:k(_,["prevent"]),class:"recover-form"},[s("div",B,[e[3]||(e[3]=s("label",{for:"email",class:"form-label"},"Correo Electrónico",-1)),s("div",M,[e[1]||(e[1]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-envelope"})],-1)),h(s("input",{type:"email",id:"email",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=x=>d.value=x),required:"",placeholder:"ejemplo@correo.com",onInput:y},null,544),[[E,d.value]])]),c.value?(i(),n("div",A,[e[2]||(e[2]=s("i",{class:"bi bi-exclamation-circle me-2"},null,-1)),o(" "+p(c.value),1)])):m("",!0)]),r.value?(i(),n("div",D,[e[4]||(e[4]=s("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),o(" "+p(r.value),1)])):m("",!0),v.value?(i(),n("div",F,[e[5]||(e[5]=s("i",{class:"bi bi-check-circle me-2"},null,-1)),o(" "+p(v.value),1)])):m("",!0),s("button",{type:"submit",class:"btn btn-primary w-100 py-2 mt-3",disabled:a.value||c.value},[a.value?(i(),n("span",z,e[6]||(e[6]=[s("span",{class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},null,-1),o(" Enviando... ")]))):(i(),n("span",H,e[7]||(e[7]=[s("i",{class:"bi bi-send me-2"},null,-1),o(" Enviar Instrucciones ")])))],8,q),s("div",L,[s("p",O,[e[9]||(e[9]=o(" ¿Recordaste tu contraseña? ")),R(b,{to:"/login",class:"text-decoration-none fw-bold"},{default:C(()=>e[8]||(e[8]=[o("Inicia sesión")])),_:1})])])],32)])])])],64)}}},K=g(U,[["__scopeId","data-v-c9b1d9d1"]]);export{K as default};
